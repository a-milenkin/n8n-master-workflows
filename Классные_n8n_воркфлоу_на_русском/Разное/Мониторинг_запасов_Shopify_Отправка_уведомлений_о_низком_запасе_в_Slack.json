{
  "id": "zn8PCtQ6ISmR8ptG",
  "meta": {
    "instanceId": "2000c64071c20843606b95c63795bb0797c41036047055a6586498e855b96efc"
  },
  "name": "–¢–†–ï–ë–û–í–ê–ù–ò–Ø –ö –ù–ê–°–¢–†–û–ô–ö–ï:",
  "tags": [],
  "nodes": [
    {
      "id": "a02768c5-a7d4-491a-b140-befbcd5f2c7b",
      "name": "Daily Inventory Check",
      "type": "n8n-nodes-base.scheduleTrigger",
      "position": [
        -840,
        340
      ],
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "cronExpression",
              "expression": "0 9 * * *"
            }
          ]
        }
      },
      "typeVersion": 1.2
    },
    {
      "id": "5b063339-70a3-4d41-a396-b3f49626ad78",
      "name": "Get All Products",
      "type": "n8n-nodes-base.shopify",
      "position": [
        -620,
        340
      ],
      "parameters": {
        "resource": "product",
        "operation": "getAll",
        "returnAll": true,
        "additionalFields": {}
      },
      "typeVersion": 1
    },
    {
      "id": "c992fedb-0c21-493f-8b0b-cbd6a7335a40",
      "name": "Filter Low Stock Items",
      "type": "n8n-nodes-base.code",
      "position": [
        -400,
        340
      ],
      "parameters": {
        "jsCode": "const lowStockThreshold = 10; // Set your threshold\nconst lowStockProducts = [];\n\nfor (const product of $input.all()) {\n  for (const variant of product.json.variants) {\n    if (variant.inventory_quantity <= lowStockThreshold && variant.inventory_quantity > 0) {\n      lowStockProducts.push({\n        product_title: product.json.title,\n        variant_title: variant.title,\n        sku: variant.sku,\n        current_stock: variant.inventory_quantity,\n        product_id: product.json.id,\n        variant_id: variant.id\n      });\n    }\n  }\n}\n\nreturn lowStockProducts.map(item => ({ json: item }));"
      },
      "typeVersion": 2
    },
    {
      "id": "ba2f6f7f-540a-4d48-99a5-75cb28c88753",
      "name": "Check if Alerts Needed",
      "type": "n8n-nodes-base.if",
      "position": [
        -180,
        340
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "condition-001",
              "operator": {
                "type": "number",
                "operation": "gt"
              },
              "leftValue": "={{ $('Filter Low Stock Items').all().length }}",
              "rightValue": 0
            }
          ]
        }
      },
      "typeVersion": 2
    },
    {
      "id": "f20e4aa3-588b-4da8-b0d4-e097711f1747",
      "name": "Format Alert Message",
      "type": "n8n-nodes-base.set",
      "position": [
        40,
        340
      ],
      "parameters": {
        "mode": "raw",
        "options": {},
        "jsonOutput": "={\n  \"alert_message\": \"üö® *Low Stock Alert*\\n\\nThe following items are running low:\\n\\n{{ $('Filter Low Stock Items').all().map(item => `‚Ä¢ ${item.json.product_title} (${item.json.variant_title}): ${item.json.current_stock} left`).join('\\n') }}\",\n  \"products_count\": \"{{ $('Filter Low Stock Items').all().length }}\"\n}"
      },
      "typeVersion": 3.4
    },
    {
      "id": "3ddc4707-1295-41cd-a874-f0601f66c995",
      "name": "Send Inventory Alert",
      "type": "n8n-nodes-base.slack",
      "position": [
        260,
        340
      ],
      "webhookId": "4d8500c1-7086-4fc8-8b8b-6ff061c4381b",
      "parameters": {
        "text": "={{ $json.alert_message }}",
        "select": "channel",
        "channelId": {
          "__rl": true,
          "mode": "list",
          "value": "C1234567890",
          "cachedResultName": "inventory"
        },
        "otherOptions": {},
        "authentication": "oAuth2"
      },
      "typeVersion": 2.3
    },
    {
      "id": "9b6e400f-d16d-44b3-8ee2-d68ac6a89fc3",
      "name": "Workflow Info",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1200,
        160
      ],
      "parameters": {
        "width": 320,
        "height": 400,
        "content": "## üì¶ –ú–û–ù–ò–¢–û–† –ù–ò–ó–ö–ò–• –ó–ê–ü–ê–°–û–í"
      },
      "typeVersion": 1
    },
    {
      "id": "2b68b93f-b4a8-49d6-bb8d-87f4028cf81c",
      "name": "Features & Config",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0,
        0
      ],
      "parameters": {
        "color": 6,
        "width": 300,
        "height": 280,
        "content": "**–ê–≤—Ç–æ—Ä: –î–≠–í–ò–î –û–õ–£–°–û–õ–ê**"
      },
      "typeVersion": 1
    },
    {
      "id": "9c1250d3-08bf-47da-bdf2-40b95bcb584d",
      "name": "Business Value",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        100,
        500
      ],
      "parameters": {
        "color": 7,
        "width": 260,
        "height": 200,
        "content": "–¶–ï–õ–¨ –†–ê–ë–û–ß–ï–ì–û –ü–†–û–¶–ï–°–°–ê:"
      },
      "typeVersion": 1
    },
    {
      "id": "9fbe2564-05df-4453-9961-fe98d0873eb4",
      "name": "Threshold Guide",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -500,
        80
      ],
      "parameters": {
        "color": 5,
        "width": 280,
        "height": 240,
        "content": "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —É—Ä–æ–≤–Ω–∏ –∑–∞–ø–∞—Å–æ–≤ Shopify –∏ —É–≤–µ–¥–æ–º–ª—è—Ç—å, –∫–æ–≥–¥–∞ –ø—Ä–æ–¥—É–∫—Ç—ã –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—Ç—Å—è"
      },
      "typeVersion": 1
    }
  ],
  "active": false,
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "50ae8a36-065f-4c4f-a27d-f1970faaae12",
  "connections": {
    "Get All Products": {
      "main": [
        [
          {
            "node": "Filter Low Stock Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Format Alert Message": {
      "main": [
        [
          {
            "node": "Send Inventory Alert",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Daily Inventory Check": {
      "main": [
        [
          {
            "node": "Get All Products",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check if Alerts Needed": {
      "main": [
        [
          {
            "node": "Format Alert Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter Low Stock Items": {
      "main": [
        [
          {
            "node": "Check if Alerts Needed",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}