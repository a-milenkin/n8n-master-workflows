{
  "id": "4Uwsl8NFCbGfns09",
  "meta": {
    "instanceId": "b3df22d2875c82e3ba1883c50049ed9cee0bcabf99d2b486961d2245a09e3964",
    "templateCredsSetupCompleted": true
  },
  "name": "AIAutomationPro Восстановить все рабочие процессы из Google Диска v1",
  "tags": [],
  "nodes": [
    {
      "id": "4499bb17-7055-47c6-a344-c30d27232c4e",
      "name": "Google Drive Get All Workflows",
      "type": "n8n-nodes-base.googleDrive",
      "position": [
        300,
        0
      ],
      "parameters": {
        "filter": {
          "folderId": {
            "__rl": true,
            "mode": "url",
            "value": "https://drive.google.com/drive/folders/1bfV3QKrchiNp4Ti2Ji6jyoM0b-SlUJwC"
          }
        },
        "options": {},
        "resource": "fileFolder",
        "returnAll": true
      },
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "q8OibtSjVurZl2tb",
          "name": "AI Auto Google Drive account"
        }
      },
      "typeVersion": 3
    },
    {
      "id": "933b1caa-4551-4620-8b90-0453d221c67b",
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        200,
        -80
      ],
      "parameters": {
        "color": 2,
        "width": 307,
        "height": 271,
        "content": "## Настройки"
      },
      "typeVersion": 1
    },
    {
      "id": "2555a429-908c-4173-9cd2-13d0fb5ecc21",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        620,
        -80
      ],
      "parameters": {
        "color": 2,
        "width": 1127,
        "height": 311,
        "content": "## Импортировать все рабочие процессы в N8n"
      },
      "typeVersion": 1
    },
    {
      "id": "e4b2c217-01ae-498f-b85c-531b80c2b929",
      "name": "Loop Over Items",
      "type": "n8n-nodes-base.splitInBatches",
      "position": [
        720,
        0
      ],
      "parameters": {
        "options": {}
      },
      "typeVersion": 3
    },
    {
      "id": "f444655c-94b0-41eb-9710-962269ef5462",
      "name": "Extract from File",
      "type": "n8n-nodes-base.extractFromFile",
      "position": [
        1140,
        20
      ],
      "parameters": {
        "options": {},
        "operation": "fromJson"
      },
      "typeVersion": 1
    },
    {
      "id": "3a3e83d8-a490-4fef-bd1c-6974b03af355",
      "name": "Wait",
      "type": "n8n-nodes-base.wait",
      "position": [
        1540,
        20
      ],
      "webhookId": "1d4c12db-215a-42d4-80e0-062bad87b7f6",
      "parameters": {
        "amount": 3
      },
      "typeVersion": 1.1
    },
    {
      "id": "9fd08d3c-a0bd-498a-b8b4-7f7f73c6d517",
      "name": "Google Drive Download Workflow",
      "type": "n8n-nodes-base.googleDrive",
      "position": [
        940,
        20
      ],
      "parameters": {
        "fileId": {
          "__rl": true,
          "mode": "id",
          "value": "={{  $('Loop Over Items').item.json.id  }}"
        },
        "options": {},
        "operation": "download"
      },
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "q8OibtSjVurZl2tb",
          "name": "AI Auto Google Drive account"
        }
      },
      "typeVersion": 3
    },
    {
      "id": "0c1e644a-736a-4fcb-9756-cde959264f72",
      "name": "n8n Create Workflow",
      "type": "n8n-nodes-base.n8n",
      "position": [
        1340,
        20
      ],
      "parameters": {
        "operation": "create",
        "requestOptions": {},
        "workflowObject": "={{ $json.data.toJsonString() }}"
      },
      "credentials": {
        "n8nApi": {
          "id": "S63rln42rAvGFfBB",
          "name": "n8n account"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "d91b1c60-db35-40cd-9923-f4264fe6fca4",
      "name": "Clicking Trigger",
      "type": "n8n-nodes-base.manualTrigger",
      "position": [
        0,
        0
      ],
      "parameters": {},
      "typeVersion": 1
    },
    {
      "id": "7588d560-33b6-41b1-a76c-eaae74091d6d",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -900,
        -220
      ],
      "parameters": {
        "width": 660,
        "height": 2280,
        "content": "## Восстановление всех рабочих процессов n8n из резервных копий Google Drive\n\nВосстановление нескольких рабочих процессов n8n вручную, особенно при **миграции вашей инстанции n8n на другой хост или сервер, может быть невероятно сложной и времязатратной задачей. Представьте, что вам нужно индивидуально экспортировать, а затем вручную импортировать сотни рабочих процессов; это рецепт для ошибок и значительного времени простоя.**\n\nЭтот рабочий процесс предоставляет упрощенный способ восстановления всех ваших рабочих процессов n8n из резервных JSON-файлов, хранящихся в назначенной папке Google Drive. Это необходимый инструмент для восстановления после катастроф, миграции рабочих процессов на новую инстанцию n8n или восстановления после случайных удалений, лучше всего использовать в сочетании с решением для резервного копирования, таким как наш [шаблон \"Автоматическое резервное копирование рабочих процессов в Google Drive\"](https://aiautomationpro.org/products/n8n-auto-backup-workflows-to-google-drive/).\n\nДля более мощных шаблонов n8n посетите наш сайт или свяжитесь с нами по адресу [**AI Automation Pro**](https://aiautomationpro.org/). Мы помогаем вашему бизнесу создавать индивидуальную автоматизацию рабочих процессов AI и приложения.\n\n### Для кого это предназначено?\n\nЭтот шаблон предназначен для:\n\n* **Пользователей и администраторов n8n:** Кто ранее создавал резервные копии своих рабочих процессов n8n в виде JSON-файлов в Google Drive.  \n* **Любого, кто нуждается в восстановлении своей настройки n8n:** Будь то из-за сбоя системы, повреждения данных, случайных удалений или во время миграции инстанции.\n\n### Какую проблему решает этот рабочий процесс? / случай использования\n\nВосстановление нескольких рабочих процессов n8n вручную может быть медленным и подверженным ошибкам процессом. Этот рабочий процесс решает эту проблему, выполняя следующие действия:\n\n* **Автоматическое массовое восстановление:** Быстро повторно импортирует все рабочие процессы из указанной папки резервного копирования Google Drive, значительно сокращая ручные усилия.  \n* **Восстановление после катастроф:** Обеспечивает быстрое восстановление вашей автоматизированной среды, минимизируя время простоя после сбоя системы или повреждения данных.  \n* **Упрощенная миграция инстанции:** Делает процесс переноса всего набора рабочих процессов на новый сервер n8n значительно более управляемым и менее подверженным ошибкам по сравнению с ручными импортами.  \n* **Целостность данных:** Помогает восстановить рабочие процессы до известного хорошего состояния из ваших резервных копий, обеспечивая согласованность после восстановления или миграции.\n\n### Что делает этот рабочий процесс\n\n1. **Ручной триггер:** Вы инициируете рабочий процесс вручную, когда требуется операция восстановления.  \n2. **Список файлов резервной копии:** Рабочий процесс получает доступ к *определенной папке Google Drive* (которую вы должны настроить) и перечисляет все файлы в ней. Предполагается, что это ваши JSON-файлы резервных копий рабочих процессов n8n.  \n3. **Итерация и обработка:** Затем он проходит через каждый файл, найденный в папке Google Drive:  \n   * **Загрузить рабочий процесс:** Загружает отдельный JSON-файл рабочего процесса из Google Drive.  \n   * **Извлечь содержимое:** Парсит загруженный файл, чтобы извлечь данные JSON, представляющие рабочий процесс.  \n   * **Импорт в n8n:** Использует API n8n для создания нового рабочего процесса (или обновления существующего, если найдено совпадение ID) в вашей текущей инстанции n8n с использованием извлеченных данных JSON.  \n   * **Шаг ожидания:** Приостанавливается на 3 секунды после попытки создать каждый рабочий процесс, чтобы помочь управлять нагрузкой на систему и избежать потенциальных проблем с ограничением скорости API.\n\n## Пошаговая настройка\n\n1. **Импорт шаблона:** Загрузите предоставленный JSON-файл в вашу инстанцию n8n.  \n2. **Настройка учетных данных:**  \n   * **Узлы Google Drive:** Вам нужно будет создать или выбрать существующие учетные данные API OAuth2 Google Drive для этих узлов.  \n   * **Узел n8n:** Настройте свои учетные данные API n8n, чтобы разрешить рабочему процессу создавать/обновлять рабочие процессы в вашей инстанции.  \n3. **Укажите папку резервного копирования Google Drive (КРИТИЧЕСКИ ВАЖНО):**  \n   * Откройте узел **\"Google Drive Get All Workflows\"**.  \n   * Найдите раздел **\"Filter\"** и в нем параметр **\"Folder ID\"**. Значение по умолчанию является заполнительным URL.  \n   * **Вы ДОЛЖНЫ изменить этот URL на прямой URL папки Google Drive, которая содержит ваши JSON-файлы резервных копий рабочих процессов n8n.** Обычно это будет одна из часовых папок (например, `n8n_backup_YYYY-MM-DD_HH`), созданных сопутствующим рабочим процессом резервного копирования.  \n4. **Активируйте рабочий процесс:** Хотя он запускается вручную, рабочий процесс должен быть активным в вашей инстанции n8n, чтобы его можно было запустить.\n\n### Как настроить этот рабочий процесс под свои нужды\n\n* **Выборочное восстановление:**  \n  * **Опция 1 (Ручная):** Перед запуском рабочего процесса вручную переместите только те конкретные JSON-файлы рабочих процессов, которые вы хотите восстановить, в исходную папку Google Drive, настроенную в узле \"Google Drive Get All Workflows\".  \n  * **Опция 2 (Автоматизированный фильтр):** Вставьте узел \"Edit Fields\" или \"Filter\" после узла \"Google Drive Get All Workflows\", чтобы программно выбрать, какие файлы (например, на основе шаблонов имен файлов) должны перейти к узлу \"Loop Over Items\" для восстановления.  \n* **Настройка времени ожидания:** Узел \"Wait\" установлен на 3 секунды. Вы можете увеличить это время, если у вас очень много рабочих процессов или если вашей инстанции n8n требуется больше времени между вызовами API. Напротив, для меньших партий на мощных инстанциях вы можете уменьшить его.  \n* **Обработка ошибок:** Для повышения надежности рассмотрите возможность добавления ветвей обработки ошибок (например, используя узлы \"Error Trigger\" или настройки \"Continue on Fail\" внутри узлов), чтобы регистрировать или отправлять уведомления, если конкретный рабочий процесс не удалось импортировать.\n\n### Важные соображения\n\n* **Перезапись/обновление рабочих процессов:** Если рабочий процесс с тем же `id`, что и в резервном JSON-файле, уже существует в вашей инстанции n8n, этот процесс восстановления обычно **обновит/перезапишет** существующий рабочий процесс версией из резервной копии. Если `id` из резервного файла не соответствует ни одному существующему рабочему процессу, будет создан новый рабочий процесс.  \n* **Идемпотентность:** Запуск этого рабочего процесса несколько раз на точно такой же папке резервного копирования приведет к повторной обработке всех файлов. Это означает, что рабочие процессы будут обновлены/перезаписаны снова, если они существуют, или созданы, если их нет. Убедитесь, что это ожидаемое поведение.  \n* **Сопутствующий рабочий процесс резервного копирования:** Этот рабочий процесс восстановления лучше всего сочетать с резервными копиями, созданными процессом, подобным нашему шаблону \"Автоматическое резервное копирование рабочих процессов в Google Drive\", который сохраняет рабочие процессы в ожидаемом формате JSON.  \n* **Тестируйте безопасно:** Настоятельно рекомендуется сначала протестировать этот рабочий процесс на непроизводственной или тестовой инстанции n8n, особенно при восстановлении большого количества критически важных рабочих процессов или если вы не уверены в поведении перезаписи в вашей конкретной настройке n8n.  \n* **Содержимое исходной папки:** Убедитесь, что указанная папка Google Drive *содержит только* JSON-файлы рабочих процессов n8n, которые вы намерены восстановить. Другие типы файлов могут вызвать ошибки в узле \"Extract from File\"."
      },
      "typeVersion": 1
    }
  ],
  "active": false,
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "80dbfa3f-a041-4b59-ac04-ca17221be845",
  "connections": {
    "Wait": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [],
        [
          {
            "node": "Google Drive Download Workflow",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Clicking Trigger": {
      "main": [
        [
          {
            "node": "Google Drive Get All Workflows",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File": {
      "main": [
        [
          {
            "node": "n8n Create Workflow",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "n8n Create Workflow": {
      "main": [
        [
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Drive Download Workflow": {
      "main": [
        [
          {
            "node": "Extract from File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Drive Get All Workflows": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}